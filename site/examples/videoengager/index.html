<!DOCTYPE html>

<html>
<head>
  <title>VideoEngager CoBrowsing Guest Demo</title>
  <meta charset="UTF-8">
  <meta name="description" content="">
  <meta name="author" content="">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- Bootstrap -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">

  <link rel="stylesheet" href="./../guestdemo.css" type="text/css"/>
  
  <script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>


  <style type="text/css" media="screen">
    .main{
      padding: 80px 15px;
    }

    h1 {
      color: #e74c3c;
    }

    .navbar {
      background: #fa6374;
    }

    .navbar-inverse .navbar-brand {
      color: #fff;
    }

    .form-control {
      padding: 0 12px;
    }

    /*reset Twitter Bootstrap*/
    @media screen {
      * {
        -webkit-box-sizing: content-box !important;
        -moz-box-sizing: content-box !important;
        box-sizing: content-box !important;
      }
    }

    .container a img {
      width: 135px;
      height: 34px;
    }

  </style>

</head>
  <body>

    <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <a class="navbar-brand pull-left" href="#">VideoEngager CoBrowsing Guest Demo</a>
      </div>
    </div>


    <div class="container">

      <div class="main">

        <div class="form-check form-switch">
          <input class="form-check-input" type="checkbox" id="togetherJSOnOFF" checked>
          <label class="form-check-label" for="togetherJSOnOFF">Enable Disable TogetherJS</label>
        </div>

        <div class="form-check form-switch">
          <input dontTrack="true" class="form-check-input" type="checkbox" id="togetherJSHideSidebar">
          <label class="form-check-label" for="togetherJSHideSidebar">Show TogetherJS Sidebar</label>
        </div>

      </div>

      <div class="accordion" id="accordionExample">
        <div class="accordion-item">
          <h2 class="accordion-header" id="headingOne">
            <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
              Send TogetherJS link to Genesys as Interaction
            </button>
          </h2>
          <div id="collapseOne" class="accordion-collapse collapsed" aria-labelledby="headingOne" data-bs-parent="#accordionExample">
            <div class="accordion-body">

                <h4>Send Invitation With Genesys:</h4>
                <div class="form-group" id="mainFrom">
                   <label if="DisplayName" for="displayName" id="name">Name</label>
                   <input type="text" class="form-control" id="displayName" placeholder="Display Name">
                   <div class="form-group">
                    <label id="Language" for="languageSelect">Language</label>
                    <select class="form-control" id="languageSelect">
                       <option value="en_US" >English</option>
                       <option value="bg_BG" >Bulgarian</option>
                       <option value="pt_PT" >Portuguese</option>
                       <option value="es_ES" >Spansih</option>
                       <option value="tr_TR" >Turkish</option>
                    </select>
                   </div>
                   <div id="debugParameters">
                     <p>OrganizationId: <input type="text" id="OrganizationId"> </p>
                     <p>DeploymentId: <input type="text" id="DeploymentId"> </p>
                     <p>VideoengagerUrl: <input type="text" id="VideoengagerUrl"> </p>
                     <p>TennathId: <input type="text" id="TennathId"> </p>
                     <p>Environment: <input type="text" id="Environment"> </p>
                     <p>Queue: <input type="text" id="Queue"></p>
                     <p>fast selection: <select id="fastSelection" name="fastSelection"><option value="de">de</option><option value="com.au">com.au</option><option value="com">com</option><option value="ie">ie</option></select></p>
                   </div>
                </div>
                <div id="error-holder" class="alert alert-danger" role="alert" style="display: none;"></div>
                <button id="clickButton">Start CoBrowsing</button>

            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- togetherjs -->
    <script>
      TogetherJSConfig_findRoom = {prefix: "togetherjstodo", max: 5};
      TogetherJSConfig_autoStart = true;
      TogetherJSConfig_suppressJoinConfirmation = true;
      TogetherJSConfig_storagePrefix = "tjs_todo";
    </script>
    
   

    <script src="https://sdk-cdn.mypurecloud.com/javascript-guest/4.1.0/purecloud-guest-chat-client.min.js"></script>
    <script>
      var require_g = require;
      require =null;
    </script>
    <script src="./../guestdemo.js"></script>
    <script src="../../togetherjs.js"></script>
    <script type="text/javascript" charset="utf-8" src="./js/app.js"></script>

    <script>
      var parameters = [
    {
        organizationId : '639292ca-14a2-400b-8670-1f545d8aa860',
        deploymentId : '1b4b1124-b51c-4c38-899f-3a90066c76cf',
        videoengagerUrl : 'https://staging.videoengager.com/',
        tennantId : 'oIiTR2XQIkb7p0ub',
        environment : 'mypurecloud.de',
        queue : "Support",
    },
    {
        organizationId : '327d10eb-0826-42cd-89b1-353ec67d33f8',
        deploymentId : 'c2eaaa5c-d755-4e51-9136-b5ee86b92af3',
        videoengagerUrl : 'https://dev.videoengager.com/',
        tennantId : 'test_tenant',
        environment : 'mypurecloud.com.au',
        queue : "video",
    },
    {
        organizationId : 'c4b553c3-ee42-4846-aeb1-f0da3d85058e',
        deploymentId : '973f8326-c601-40c6-82ce-b87e6dafef1c',
        videoengagerUrl : 'https://videome.leadsecure.com/',
        tennantId : '0FphTk091nt7G1W7',
        environment : 'mypurecloud.com',
        queue : "TestQueue",
    },
    {
        organizationId : '42ef203c-4d40-44e5-8a6e-d978b52f678c',
        deploymentId : 'ad6b1559-ec02-402e-ad28-d9386af34ac4',
        videoengagerUrl : 'https://videome.leadsecure.com/',
        tennantId : 'zwqqsB7k16V0YBpW',
        environment : 'mypurecloud.ie',
        queue : "ZlatkoQueue",
    }
]

var selectedParameters = {
    organizationId : '',
    deploymentId : '',
    videoengagerUrl : '',
    tennantId : '',
    environment : '',
    queue : '',
}

var customerName = function() {
    return "Customer " + Math.floor(Math.random() * 10 + 1);
}

var setDebugParams = function(){
    $( "#OrganizationId" ).val(selectedParameters.organizationId);
    $( "#DeploymentId" ).val(selectedParameters.deploymentId);
    $( "#VideoengagerUrl" ).val(selectedParameters.videoengagerUrl);
    $( "#TennathId" ).val(selectedParameters.tennantId);
    $( "#Environment" ).val(selectedParameters.environment);
    $( "#Queue" ).val(selectedParameters.queue);
}

var getCustomDebugParams = function(index){
    selectedParameters.organizationId = $( "#OrganizationId" ).val();
    selectedParameters.deploymentId = $( "#DeploymentId" ).val();
    selectedParameters.videoengagerUrl = $( "#VideoengagerUrl" ).val();
    selectedParameters.tennantId = $( "#TennathId" ).val();
    selectedParameters.environment = $( "#Environment" ).val();
    selectedParameters.queue = $( "#Queue" ).val();

    if (audioBtn) {
        audioBtn.setDisplayName($('#displayName').val());
    }

    if (videoengager) {
        videoengager.setDisplayName($('#displayName').val());
    }     
            
}

function randID () {
    return Math.floor(Math.random() * 26) + Date.now()
}

function newToast (mainText, error_class, in_function) {
    var id = randID();
    $( "body" ).append( `<div id="toast` + id + `" class="toast" data-autohide="false"> <div class="toast-header">
       <strong class="mr-auto text-primary">` + error_class + `</strong>
       <small class="text-muted">` + new Date().toLocaleString() + `</small>
       <button type="button" class="ml-2 mb-1 close" data-dismiss="toast">&times;</button>
       </div>
       <div class="toast-body"> 
       <p> In: <b>` + in_function + `</b> function</p>
       ` + mainText + `
       </div>
    </div>` );
      
    $('#toast'+ id).toast('show');
}

function ErrorToast(err)  {
    // here we show error messages in a Toast
    newToast(err.message.toString(), err.error_class, err.in_function);
}

var audioBtn;
var setVE = function(){
 
    videoengager.setOrganizationId(selectedParameters.organizationId);
    videoengager.setDeploymentId(selectedParameters.deploymentId);
    videoengager.setVideoengagerUrl(selectedParameters.videoengagerUrl);
    videoengager.setTenantId(selectedParameters.tennantId);
    videoengager.setEnvironment(selectedParameters.environment);
    videoengager.setQueue(selectedParameters.queue);
    
}
$('#fastSelection').append($('<option>', { value: "de", text: 'de' }));
    $('#fastSelection').append($('<option>', { value: "com.au", text: 'com.au' }));
    $('#fastSelection').append($('<option>', { value: "com", text: 'com' }));
    $('#fastSelection').append($('<option>', { value: "ie", text: 'ie' }));
    
    $("#fastSelection").change(function(){
        var selected = $(this).children("option:selected").val();
    
        if(selected == "com"){
            selectedParameters = parameters[2];
        } else if (selected == "de"){
            selectedParameters = parameters[0];
        } else if (selected == "com.au"){
            selectedParameters = parameters[1];
        } else if (selected == "ie"){
            selectedParameters = parameters[3];
        } 
        setDebugParams();
        setVE();
    });

    $("#languageSelect").change(function(){
        var lang = $("#languageSelect").val();
        audioBtn.setLocale(lang);
        videoengager.setLocale(lang);
    });

    $('input,select').change(function() { 
        getCustomDebugParams();
    });

    selectedParameters = parameters[1];
    selected = "com.au";
    setDebugParams();
    getCustomDebugParams();
    setVE();

    </script>
<script>
    $(document).ready(function() {
    
      let videoengagerUrl;
      let url = window.location.href;
      if(url.indexOf("test-url=5fc9") == -1) {
        videoengagerUrl = 'https://videome.leadsecure.com/';
      } else {
        videoengagerUrl = 'https://test.videoengager.com/';
      }
      videoengager.setVideoengagerUrl(videoengagerUrl);
      
      // Optional params
      // Start with camera on or off.
      // true - ignore SmartVideo setting 'Customer starts the call with camera ON'
      // false - use SmartVideo setting 'Customer starts the call with camera ON'
      videoengager.setVideoOn(false);
      videoengager.setButtonStartLabel('Click2Video');
      videoengager.setButtonEndLabel('Stop it');
      // Clean-up video holder after video ended
      videoengager.setCleanUpVideoHolder(false);
      
      // Callbacks
      videoengager.afterGenerateInteractionDataCallback(() => {
        $("#interactionId").val(videoengager.getInteractionId());
      });
      videoengager.startButtonPressed(() => {
        $("#error-holder").hide();
        videoengager.setDisplayName($("#displayName").val());
        videoengager.setFirstName("mustafa");
        videoengager.setLastName("ipekbayrak");
        
        videoengager.setQueue(selectedParameters.queue);
        videoengager.setOrganizationId(selectedParameters.organizationId);
        videoengager.setDeploymentId(selectedParameters.deploymentId);
        videoengager.setEnvironment(selectedParameters.environment);
        videoengager.setTenantId(selectedParameters.tennantId);
        videoengager.setCoBrowseURL(window.TogetherJS.shareUrl());
      });
      videoengager.onError((err) => {
        if(err.code == 'all_input_fields_are_required') {
          $("#error-holder").attr("class", "alert alert-danger");
          $("#error-holder").attr("role", "alert");
          $("#error-holder").html("All input fields are required");
          $("#error-holder").show();
        }
      });
      
      // Required 
      videoengager.init();
      
      $("#displayName").val("Customer " + Math.floor(Math.random()*10+1));
    });
    </script>
  </body>
</html>
